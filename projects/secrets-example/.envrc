use nix

require_pass() {
  if ! pass "$1" >/dev/null 2>&1; then
    echo "Missing secret: $1"
    return 1
  fi
}

export_secret() {
  local path="$1"
  local var="$2"
  export "$var=$(pass "$path")"
}

require_pass dev/secrets-example/local/github-token
require_pass dev/secrets-example/local/postgres-password

export_secret dev/secrets-example/local/github-token GITHUB_TOKEN
export_secret dev/secrets-example/local/postgres-password POSTGRES_PASSWORD
